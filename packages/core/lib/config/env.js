"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createCliEnv = createCliEnv;

/**
 * Initialize node environment variables
 */
const path = require("path");

const dotenv = require('dotenv');

const dotenvExpand = require('dotenv-expand');

const cwd = process.cwd();
const prefixRE = /^WEB_APP_/;
const envPath = path.join(cwd, 'env');

function createCliEnv() {
  const envConfig = { ...dotenv.config({
      debug: process.env.DEBUG,
      path: path.join(envPath, `.env.${process.env.CRANE_BUILD_MODE}`)
    }),
    ...dotenv.config({
      debug: process.env.DEBUG,
      path: path.join(envPath, '.env._base')
    })
  };
  const clientEnv = {};
  dotenvExpand(envConfig);
  Object.keys(process.env).forEach(key => {
    if (prefixRE.test(key) || key === 'NODE_ENV' || key === 'CRANE_BUILD_MODE') {
      clientEnv[key] = process.env[key];
    }
  });
  return clientEnv;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb25maWcvZW52LmpzIl0sIm5hbWVzIjpbInBhdGgiLCJyZXF1aXJlIiwiZG90ZW52IiwiZG90ZW52RXhwYW5kIiwiY3dkIiwicHJvY2VzcyIsInByZWZpeFJFIiwiZW52UGF0aCIsImpvaW4iLCJjcmVhdGVDbGlFbnYiLCJlbnZDb25maWciLCJjb25maWciLCJkZWJ1ZyIsImVudiIsIkRFQlVHIiwiQ1JBTkVfQlVJTERfTU9ERSIsImNsaWVudEVudiIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwia2V5IiwidGVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLElBQUksR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBcEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxNQUFNRSxZQUFZLEdBQUdGLE9BQU8sQ0FBQyxlQUFELENBQTVCOztBQUNBLE1BQU1HLEdBQUcsR0FBR0MsT0FBTyxDQUFDRCxHQUFSLEVBQVo7QUFDQSxNQUFNRSxRQUFRLEdBQUcsV0FBakI7QUFDQSxNQUFNQyxPQUFPLEdBQUdQLElBQUksQ0FBQ1EsSUFBTCxDQUFVSixHQUFWLEVBQWUsS0FBZixDQUFoQjs7QUFFTyxTQUFTSyxZQUFULEdBQXlCO0FBQzVCLFFBQU1DLFNBQVMsR0FBRyxFQUNkLEdBQUdSLE1BQU0sQ0FBQ1MsTUFBUCxDQUFjO0FBQ2JDLE1BQUFBLEtBQUssRUFBRVAsT0FBTyxDQUFDUSxHQUFSLENBQVlDLEtBRE47QUFFYmQsTUFBQUEsSUFBSSxFQUFFQSxJQUFJLENBQUNRLElBQUwsQ0FBVUQsT0FBVixFQUFvQixRQUFPRixPQUFPLENBQUNRLEdBQVIsQ0FBWUUsZ0JBQWlCLEVBQXhEO0FBRk8sS0FBZCxDQURXO0FBS2QsT0FBR2IsTUFBTSxDQUFDUyxNQUFQLENBQWM7QUFDYkMsTUFBQUEsS0FBSyxFQUFFUCxPQUFPLENBQUNRLEdBQVIsQ0FBWUMsS0FETjtBQUViZCxNQUFBQSxJQUFJLEVBQUVBLElBQUksQ0FBQ1EsSUFBTCxDQUFVRCxPQUFWLEVBQW1CLFlBQW5CO0FBRk8sS0FBZDtBQUxXLEdBQWxCO0FBVUEsUUFBTVMsU0FBUyxHQUFHLEVBQWxCO0FBRUFiLEVBQUFBLFlBQVksQ0FBQ08sU0FBRCxDQUFaO0FBRUFPLEVBQUFBLE1BQU0sQ0FBQ0MsSUFBUCxDQUFZYixPQUFPLENBQUNRLEdBQXBCLEVBQXlCTSxPQUF6QixDQUFpQ0MsR0FBRyxJQUFJO0FBQ3BDLFFBQUlkLFFBQVEsQ0FBQ2UsSUFBVCxDQUFjRCxHQUFkLEtBQ0dBLEdBQUcsS0FBSyxVQURYLElBRUdBLEdBQUcsS0FBSyxrQkFGZixFQUdFO0FBQ0VKLE1BQUFBLFNBQVMsQ0FBQ0ksR0FBRCxDQUFULEdBQWlCZixPQUFPLENBQUNRLEdBQVIsQ0FBWU8sR0FBWixDQUFqQjtBQUNIO0FBQ0osR0FQRDtBQVNBLFNBQU9KLFNBQVA7QUFDSCIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogSW5pdGlhbGl6ZSBub2RlIGVudmlyb25tZW50IHZhcmlhYmxlc1xuICovXG5cbmNvbnN0IHBhdGggPSByZXF1aXJlKFwicGF0aFwiKVxuY29uc3QgZG90ZW52ID0gcmVxdWlyZSgnZG90ZW52JylcbmNvbnN0IGRvdGVudkV4cGFuZCA9IHJlcXVpcmUoJ2RvdGVudi1leHBhbmQnKVxuY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKVxuY29uc3QgcHJlZml4UkUgPSAvXldFQl9BUFBfL1xuY29uc3QgZW52UGF0aCA9IHBhdGguam9pbihjd2QsICdlbnYnKVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlQ2xpRW52ICgpIHtcbiAgICBjb25zdCBlbnZDb25maWcgPSB7XG4gICAgICAgIC4uLmRvdGVudi5jb25maWcoe1xuICAgICAgICAgICAgZGVidWc6IHByb2Nlc3MuZW52LkRFQlVHLFxuICAgICAgICAgICAgcGF0aDogcGF0aC5qb2luKGVudlBhdGgsIGAuZW52LiR7cHJvY2Vzcy5lbnYuQ1JBTkVfQlVJTERfTU9ERX1gKVxuICAgICAgICB9KSxcbiAgICAgICAgLi4uZG90ZW52LmNvbmZpZyh7XG4gICAgICAgICAgICBkZWJ1ZzogcHJvY2Vzcy5lbnYuREVCVUcsXG4gICAgICAgICAgICBwYXRoOiBwYXRoLmpvaW4oZW52UGF0aCwgJy5lbnYuX2Jhc2UnKVxuICAgICAgICB9KVxuICAgIH1cbiAgICBjb25zdCBjbGllbnRFbnYgPSB7fVxuXG4gICAgZG90ZW52RXhwYW5kKGVudkNvbmZpZylcblxuICAgIE9iamVjdC5rZXlzKHByb2Nlc3MuZW52KS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgIGlmIChwcmVmaXhSRS50ZXN0KGtleSlcbiAgICAgICAgICAgIHx8IGtleSA9PT0gJ05PREVfRU5WJ1xuICAgICAgICAgICAgfHwga2V5ID09PSAnQ1JBTkVfQlVJTERfTU9ERSdcbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjbGllbnRFbnZba2V5XSA9IHByb2Nlc3MuZW52W2tleV1cbiAgICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gY2xpZW50RW52XG59XG4iXX0=