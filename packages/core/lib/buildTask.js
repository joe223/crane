"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createBuildTask = createBuildTask;

var _builder = require("@cranejs/builder");

var _env = require("./config/env");

var _config = require("./config");

var _shared = require("@cranejs/shared");

async function createBuildTask(modules, buildType) {
  const buildConfigMap = _config.config.pages;
  const builderConfig = modules.map(moduleName => {
    return (0, _builder.createBuilderConfig)(buildConfigMap[moduleName], moduleName, _env.clientEnv, buildType);
  });

  _shared.logger.debug(modules);

  return async function () {
    return (0, _builder.builder)(builderConfig, buildType === _shared.BuildType.dev);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9idWlsZFRhc2suanMiXSwibmFtZXMiOlsiY3JlYXRlQnVpbGRUYXNrIiwibW9kdWxlcyIsImJ1aWxkVHlwZSIsImJ1aWxkQ29uZmlnTWFwIiwiY29uZmlnIiwicGFnZXMiLCJidWlsZGVyQ29uZmlnIiwibWFwIiwibW9kdWxlTmFtZSIsImNsaWVudEVudiIsImxvZ2dlciIsImRlYnVnIiwiQnVpbGRUeXBlIiwiZGV2Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRU8sZUFBZUEsZUFBZixDQUFnQ0MsT0FBaEMsRUFBeUNDLFNBQXpDLEVBQW9EO0FBQ3ZELFFBQU1DLGNBQWMsR0FBR0MsZUFBT0MsS0FBOUI7QUFDQSxRQUFNQyxhQUFhLEdBQUdMLE9BQU8sQ0FBQ00sR0FBUixDQUFhQyxVQUFELElBQWdCO0FBQzlDLFdBQU8sa0NBQ0hMLGNBQWMsQ0FBQ0ssVUFBRCxDQURYLEVBRUhBLFVBRkcsRUFHSEMsY0FIRyxFQUlIUCxTQUpHLENBQVA7QUFLSCxHQU5xQixDQUF0Qjs7QUFRQVEsaUJBQU9DLEtBQVAsQ0FBYVYsT0FBYjs7QUFFQSxTQUFPLGtCQUFrQjtBQUNyQixXQUFPLHNCQUFRSyxhQUFSLEVBQXVCSixTQUFTLEtBQUtVLGtCQUFVQyxHQUEvQyxDQUFQO0FBQ0gsR0FGRDtBQUdIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYnVpbGRlciwgY3JlYXRlQnVpbGRlckNvbmZpZyB9IGZyb20gJ0BjcmFuZWpzL2J1aWxkZXInXG5pbXBvcnQgeyBjbGllbnRFbnYgfSBmcm9tICcuL2NvbmZpZy9lbnYnXG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCB7IGxvZ2dlcixCdWlsZFR5cGUgfSBmcm9tICdAY3JhbmVqcy9zaGFyZWQnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWlsZFRhc2sgKG1vZHVsZXMsIGJ1aWxkVHlwZSkge1xuICAgIGNvbnN0IGJ1aWxkQ29uZmlnTWFwID0gY29uZmlnLnBhZ2VzXG4gICAgY29uc3QgYnVpbGRlckNvbmZpZyA9IG1vZHVsZXMubWFwKChtb2R1bGVOYW1lKSA9PiB7XG4gICAgICAgIHJldHVybiBjcmVhdGVCdWlsZGVyQ29uZmlnKFxuICAgICAgICAgICAgYnVpbGRDb25maWdNYXBbbW9kdWxlTmFtZV0sXG4gICAgICAgICAgICBtb2R1bGVOYW1lLFxuICAgICAgICAgICAgY2xpZW50RW52LFxuICAgICAgICAgICAgYnVpbGRUeXBlKVxuICAgIH0pXG5cbiAgICBsb2dnZXIuZGVidWcobW9kdWxlcylcblxuICAgIHJldHVybiBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBidWlsZGVyKGJ1aWxkZXJDb25maWcsIGJ1aWxkVHlwZSA9PT0gQnVpbGRUeXBlLmRldilcbiAgICB9XG59XG4iXX0=