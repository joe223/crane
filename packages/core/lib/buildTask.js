"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createBuildTask = createBuildTask;

var _builder = require("@cranejs/builder");

var _env = require("./config/env");

var _config = require("./config");

var _shared = require("@cranejs/shared");

async function createBuildTask(modules, buildType) {
  const buildConfigMap = _config.config.pages;
  const builderConfig = modules.map(moduleName => {
    return (0, _builder.createBuilderConfig)(buildConfigMap[moduleName], moduleName, _env.clientEnv, buildType);
  });
  return async function () {
    return (0, _builder.builder)(builderConfig, buildType === _shared.BuildType.dev);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9idWlsZFRhc2suanMiXSwibmFtZXMiOlsiY3JlYXRlQnVpbGRUYXNrIiwibW9kdWxlcyIsImJ1aWxkVHlwZSIsImJ1aWxkQ29uZmlnTWFwIiwiY29uZmlnIiwicGFnZXMiLCJidWlsZGVyQ29uZmlnIiwibWFwIiwibW9kdWxlTmFtZSIsImNsaWVudEVudiIsIkJ1aWxkVHlwZSIsImRldiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUVPLGVBQWVBLGVBQWYsQ0FBZ0NDLE9BQWhDLEVBQXlDQyxTQUF6QyxFQUFvRDtBQUN2RCxRQUFNQyxjQUFjLEdBQUdDLGVBQU9DLEtBQTlCO0FBQ0EsUUFBTUMsYUFBYSxHQUFHTCxPQUFPLENBQUNNLEdBQVIsQ0FBYUMsVUFBRCxJQUFnQjtBQUM5QyxXQUFPLGtDQUNITCxjQUFjLENBQUNLLFVBQUQsQ0FEWCxFQUVIQSxVQUZHLEVBR0hDLGNBSEcsRUFJSFAsU0FKRyxDQUFQO0FBS0gsR0FOcUIsQ0FBdEI7QUFRQSxTQUFPLGtCQUFrQjtBQUNyQixXQUFPLHNCQUFRSSxhQUFSLEVBQXVCSixTQUFTLEtBQUtRLGtCQUFVQyxHQUEvQyxDQUFQO0FBQ0gsR0FGRDtBQUdIIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgYnVpbGRlciwgY3JlYXRlQnVpbGRlckNvbmZpZyB9IGZyb20gJ0BjcmFuZWpzL2J1aWxkZXInXG5pbXBvcnQgeyBjbGllbnRFbnYgfSBmcm9tICcuL2NvbmZpZy9lbnYnXG5pbXBvcnQgeyBjb25maWcgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCB7IGxvZ2dlcixCdWlsZFR5cGUgfSBmcm9tICdAY3JhbmVqcy9zaGFyZWQnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVCdWlsZFRhc2sgKG1vZHVsZXMsIGJ1aWxkVHlwZSkge1xuICAgIGNvbnN0IGJ1aWxkQ29uZmlnTWFwID0gY29uZmlnLnBhZ2VzXG4gICAgY29uc3QgYnVpbGRlckNvbmZpZyA9IG1vZHVsZXMubWFwKChtb2R1bGVOYW1lKSA9PiB7XG4gICAgICAgIHJldHVybiBjcmVhdGVCdWlsZGVyQ29uZmlnKFxuICAgICAgICAgICAgYnVpbGRDb25maWdNYXBbbW9kdWxlTmFtZV0sXG4gICAgICAgICAgICBtb2R1bGVOYW1lLFxuICAgICAgICAgICAgY2xpZW50RW52LFxuICAgICAgICAgICAgYnVpbGRUeXBlKVxuICAgIH0pXG5cbiAgICByZXR1cm4gYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gYnVpbGRlcihidWlsZGVyQ29uZmlnLCBidWlsZFR5cGUgPT09IEJ1aWxkVHlwZS5kZXYpXG4gICAgfVxufVxuIl19