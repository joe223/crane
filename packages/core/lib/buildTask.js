"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createBuildTask = createBuildTask;

var _builder = require("@cranejs/builder");

var _env = require("./config/env");

var _config = require("./config");

var _shared = require("@cranejs/shared");

async function createBuildTask(modules, buildType) {
  const clientEnv = (0, _env.createCliEnv)();
  const buildConfigMap = _config.config.pages;
  const builderConfig = modules.map(moduleName => {
    return (0, _builder.createBuilderConfig)(buildConfigMap[moduleName], moduleName, clientEnv, buildType);
  });
  return async function () {
    return (0, _builder.builder)(builderConfig, buildType === _shared.BuildType.dev);
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9idWlsZFRhc2suanMiXSwibmFtZXMiOlsiY3JlYXRlQnVpbGRUYXNrIiwibW9kdWxlcyIsImJ1aWxkVHlwZSIsImNsaWVudEVudiIsImJ1aWxkQ29uZmlnTWFwIiwiY29uZmlnIiwicGFnZXMiLCJidWlsZGVyQ29uZmlnIiwibWFwIiwibW9kdWxlTmFtZSIsIkJ1aWxkVHlwZSIsImRldiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUVPLGVBQWVBLGVBQWYsQ0FBZ0NDLE9BQWhDLEVBQXlDQyxTQUF6QyxFQUFvRDtBQUN2RCxRQUFNQyxTQUFTLEdBQUcsd0JBQWxCO0FBQ0EsUUFBTUMsY0FBYyxHQUFHQyxlQUFPQyxLQUE5QjtBQUNBLFFBQU1DLGFBQWEsR0FBR04sT0FBTyxDQUFDTyxHQUFSLENBQWFDLFVBQUQsSUFBZ0I7QUFDOUMsV0FBTyxrQ0FDSEwsY0FBYyxDQUFDSyxVQUFELENBRFgsRUFFSEEsVUFGRyxFQUdITixTQUhHLEVBSUhELFNBSkcsQ0FBUDtBQUtILEdBTnFCLENBQXRCO0FBUUEsU0FBTyxrQkFBa0I7QUFDckIsV0FBTyxzQkFBUUssYUFBUixFQUF1QkwsU0FBUyxLQUFLUSxrQkFBVUMsR0FBL0MsQ0FBUDtBQUNILEdBRkQ7QUFHSCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGJ1aWxkZXIsIGNyZWF0ZUJ1aWxkZXJDb25maWcgfSBmcm9tICdAY3JhbmVqcy9idWlsZGVyJ1xuaW1wb3J0IHsgY3JlYXRlQ2xpRW52IH0gZnJvbSAnLi9jb25maWcvZW52J1xuaW1wb3J0IHsgY29uZmlnIH0gZnJvbSAnLi9jb25maWcnXG5pbXBvcnQgeyBsb2dnZXIsIEJ1aWxkVHlwZSB9IGZyb20gJ0BjcmFuZWpzL3NoYXJlZCdcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUJ1aWxkVGFzayAobW9kdWxlcywgYnVpbGRUeXBlKSB7XG4gICAgY29uc3QgY2xpZW50RW52ID0gY3JlYXRlQ2xpRW52KClcbiAgICBjb25zdCBidWlsZENvbmZpZ01hcCA9IGNvbmZpZy5wYWdlc1xuICAgIGNvbnN0IGJ1aWxkZXJDb25maWcgPSBtb2R1bGVzLm1hcCgobW9kdWxlTmFtZSkgPT4ge1xuICAgICAgICByZXR1cm4gY3JlYXRlQnVpbGRlckNvbmZpZyhcbiAgICAgICAgICAgIGJ1aWxkQ29uZmlnTWFwW21vZHVsZU5hbWVdLFxuICAgICAgICAgICAgbW9kdWxlTmFtZSxcbiAgICAgICAgICAgIGNsaWVudEVudixcbiAgICAgICAgICAgIGJ1aWxkVHlwZSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGJ1aWxkZXIoYnVpbGRlckNvbmZpZywgYnVpbGRUeXBlID09PSBCdWlsZFR5cGUuZGV2KVxuICAgIH1cbn1cbiJdfQ==